# 49 - ç¼–ç å™¨å’Œè§£ç å™¨

---

### ğŸ¦ æœ¬èŠ‚è¯¾ç¨‹è§†é¢‘åœ°å€ ğŸ‘‰
[![Bilibil](https://i1.hdslb.com/bfs/archive/e6e6a431793630d37f11edc1f4f0c9453b175f1c.jpg@640w_400h_100Q_1c.webp)](https://www.bilibili.com/video/BV1c54y1E7YP)
## ç¼–ç å™¨å’Œè§£ç å™¨

![](\Images/049-01.gif)

**é‡æ–°è€ƒå¯ŸCNN**

- ç¼–ç å™¨ï¼šå°†è¾“å…¥ç¼–ç¨‹æˆä¸­é—´è¡¨è¾¾å½¢å¼ï¼ˆç‰¹å¾ï¼‰
- è§£ç å™¨ï¼šå°†ä¸­é—´è¡¨ç¤ºè§£ç æˆè¾“å‡º

**é‡æ–°è€ƒå¯ŸRNN**

- ç¼–ç å™¨ï¼šå°†æ–‡æœ¬è¡¨ç¤ºæˆå‘é‡
- è§£ç å™¨ï¼šå°†å‘é‡è¡¨ç¤ºæˆè¾“å‡º

**ç¼–ç å™¨-è§£ç å™¨æ¶æ„**

- ä¸€ä¸ªæ¨¡å‹è¢«åˆ†ä¸ºä¸¤å—
  - ç¼–ç å™¨å¤„ç†è¾“å…¥
  - è§£ç å™¨ç”Ÿæˆè¾“å‡º
    - è§£ç å™¨å¯ä»¥æœ‰é¢å¤–çš„è¾“å…¥

![](\Images/049-02ï¼ˆ2ï¼‰.jpg)

**API**
é‡Šä¹‰æ¥è‡ªäºç™¾åº¦ï¼š
APIï¼ˆApplication Programming Interfaceï¼Œåº”ç”¨ç¨‹åºæ¥å£ï¼‰æ˜¯ä¸€äº›é¢„å…ˆå®šä¹‰çš„æ¥å£ï¼ˆå¦‚å‡½æ•°ã€HTTPæ¥å£ï¼‰ï¼Œæˆ–æŒ‡è½¯ä»¶ç³»ç»Ÿä¸åŒç»„æˆéƒ¨åˆ†è¡”æ¥çš„çº¦å®šã€‚ç”¨æ¥æä¾›åº”ç”¨ç¨‹åºä¸å¼€å‘äººå‘˜åŸºäºæŸè½¯ä»¶æˆ–ç¡¬ä»¶å¾—ä»¥è®¿é—®çš„ä¸€ç»„ä¾‹ç¨‹ï¼Œè€Œåˆæ— éœ€è®¿é—®æºç ï¼Œæˆ–ç†è§£å†…éƒ¨å·¥ä½œæœºåˆ¶çš„ç»†èŠ‚ã€‚

### ä»£ç å®ç°

**ç¼–ç å™¨**

```
from torch import nn

class Encoder(nn.Module):
    """ç¼–ç å™¨-è§£ç å™¨æ¶æ„çš„åŸºæœ¬ç¼–ç å™¨æ¥å£"""
    def __init__(self, **kwargs):
        super(Encoder, self).__init__(**kwargs)

    def forward(self, X, *args):
        raise NotImplementedError
        # åœ¨ç¨‹åºçš„æŒ‡å®šä½ç½®æ‰‹åŠ¨æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸
```

**è§£ç å™¨**

```
class Decoder(nn.Module):
    """ç¼–ç å™¨-è§£ç å™¨æ¶æ„çš„åŸºæœ¬è§£ç å™¨æ¥å£"""
    def __init__(self, **kwargs):
        super(Decoder, self).__init__(**kwargs)

    def init_state(self, enc_outputs, *args):
        #æ‹¿åˆ°encçš„è¾“å‡ºï¼Œè½¬æ¢æˆä¸­é—´å½¢å¼
        raise NotImplementedError

    def forward(self, X, state):
        raise NotImplementedError
        
```

**ç¼–è§£ç å™¨**

```
class EncoderDecoder(nn.Module):
    """ç¼–ç å™¨-è§£ç å™¨æ¶æ„çš„åŸºç±»"""
    def __init__(self, encoder, decoder, **kwargs):
        super(EncoderDecoder, self).__init__(**kwargs)
        self.encoder = encoder
        self.decoder = decoder

    def forward(self, enc_X, dec_X, *args):
        enc_outputs = self.encoder(enc_X, *args)
        dec_state = self.decoder.init_state(enc_outputs, *args)
        return self.decoder(dec_X, dec_state)
```
**æ€»ç»“**
- ç¼–ç å™¨è¿›è¡Œè¾“å…¥-è¾“å‡ºè½¬åŒ–
- è§£ç å™¨æŠŠç¼–ç å™¨è¾“å‡ºç¼–ç æˆä¸­é—´stateï¼Œè”åˆè¾“å…¥ï¼Œå®ç°æœ€ç»ˆè¾“å‡º
- è¿™ä¸€æ¶æ„å°±æ˜¯NLPå®ç°çš„åŸºç¡€